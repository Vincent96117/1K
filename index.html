<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>V178 HUNTER | æ‰‹å‹•ç›£æ§ç‰ˆ</title>
    <style>
        body { background: #050505; color: #e0e0e0; font-family: 'PingFang TC', sans-serif; padding: 20px; text-align: center; }
        .header { display: flex; justify-content: center; gap: 40px; background: #111; padding: 20px; border-radius: 12px; border: 1px solid #333; margin-bottom: 20px; }
        .market-card { min-width: 150px; }
        .price { font-size: 24px; font-weight: bold; color: #f2a900; margin-top: 5px; }
        .up { color: #00ff88; } .down { color: #ff3344; }
        
        #startBtn { 
            background: #f2a900; color: #000; border: none; padding: 15px 40px; font-size: 18px; 
            font-weight: bold; border-radius: 8px; cursor: pointer; margin-bottom: 30px; transition: 0.3s;
        }
        #startBtn:hover { background: #ffd04d; transform: scale(1.05); }
        #startBtn:disabled { background: #444; color: #888; cursor: not-allowed; }

        .status-bar { color: #888; margin-bottom: 10px; font-size: 14px; }
        table { width: 100%; border-collapse: collapse; background: #111; margin-top: 10px; text-align: left; }
        th { background: #1a1a1a; color: #f2a900; padding: 15px; border-bottom: 2px solid #333; }
        td { padding: 15px; border-bottom: 1px solid #222; font-size: 16px; }
        .trigger-tag { background: #ff3344; color: white; padding: 2px 6px; border-radius: 4px; font-size: 12px; }
    </style>
</head>
<body>

    <div class="header" id="market-header">
        <div class="market-card">
            <div>BTC / USDT</div>
            <div id="btc-price" class="price">--</div>
            <div id="btc-chg">--</div>
        </div>
        <div class="market-card">
            <div>ETH / USDT</div>
            <div id="eth-price" class="price">--</div>
            <div id="eth-chg">--</div>
        </div>
    </div>

    <button id="startBtn" onclick="startMonitoring()">ğŸš€ é–‹å§‹ V178 å¯¦æ™‚ç›£æ§</button>
    <div id="status" class="status-bar">ç›®å‰ç‹€æ…‹ï¼šç­‰å¾…æŒ‡ä»¤</div>

    <table>
        <thead>
            <tr>
                <th>è§¸ç™¼æ™‚é–“</th>
                <th>å¹£ç¨®åç¨±</th>
                <th>1m çˆ†ç™¼æ¼²å¹…</th>
                <th>V178 å³æ™‚è©•åˆ†</th>
                <th>ç•¶å‰åƒ¹æ ¼</th>
            </tr>
        </thead>
        <tbody id="watchlist">
            </tbody>
    </table>

<script>
    const watchlistSymbols = new Set();
    let isRunning = false;
    let btcChange = 0;

    // å–å¾—å¤§ç›¤å³æ™‚è¡Œæƒ…
    async function updateMarket() {
        const res = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr?symbols=["BTCUSDT","ETHUSDT"]');
        const data = await res.json();
        data.forEach(c => {
            const isBTC = c.symbol === "BTCUSDT";
            if(isBTC) btcChange = parseFloat(c.priceChangePercent);
            document.getElementById(isBTC ? 'btc-price' : 'eth-price').innerText = parseFloat(c.lastPrice).toLocaleString();
            const chgEl = document.getElementById(isBTC ? 'btc-chg' : 'eth-chg');
            chgEl.innerText = `${parseFloat(c.priceChangePercent).toFixed(2)}%`;
            chgEl.className = parseFloat(c.priceChangePercent) >= 0 ? 'up' : 'down';
        });
    }

    // é–‹å§‹æƒæçˆ†ç™¼
    async function scan() {
        if (!isRunning) return;
        document.getElementById('status').innerText = `æ­£åœ¨æƒæå…¨å ´å¹£ç¨®... æœ€å¾Œæ›´æ–°: ${new Date().toLocaleTimeString()}`;
        
        try {
            const res = await fetch('https://fapi.binance.com/fapi/v1/ticker/24hr');
            const all = await res.json();
            // æ’é™¤ä½ æŒ‡å®šçš„å¹£ç¨®
            const filtered = all.filter(c => !['BTCUSDT','ETHUSDT','SOLUSDT','XRPUSDT','BNBUSDT','BNXUSDT'].includes(c.symbol));
            // æŠ“æˆäº¤é‡å‰ 100 åç¢ºä¿æµå‹•æ€§
            const top100 = filtered.sort((a,b) => b.quoteVolume - a.quoteVolume).slice(0, 100);

            for (let coin of top100) {
                // å¦‚æœå·²ç¶“åœ¨åå–®å…§ï¼Œåƒ…æ›´æ–°åƒ¹æ ¼èˆ‡è©•åˆ†
                if (watchlistSymbols.has(coin.symbol)) {
                    document.getElementById(`price-${coin.symbol}`).innerText = coin.lastPrice;
                    const rs = (parseFloat(coin.priceChangePercent) - btcChange) * 10;
                    document.getElementById(`score-${coin.symbol}`).innerText = Math.floor(rs + 20);
                    continue;
                }

                // æª¢æŸ¥ K ç·šçˆ†ç™¼
                const kRes = await fetch(`https://fapi.binance.com/fapi/v1/klines?symbol=${coin.symbol}&interval=1m&limit=2`);
                const k = await kRes.json();
                const k1_open = parseFloat(k[0][1]);
                const k2_close = parseFloat(k[1][4]);
                const growth = ((k2_close - k1_open) / k1_open) * 100;

                // è§¸ç™¼æ¢ä»¶: å–®æ ¹æˆ–é›™æ ¹ç´¯è¨ˆ > 1.5%
                if (growth >= 1.5) {
                    watchlistSymbols.add(coin.symbol);
                    const rs = (parseFloat(coin.priceChangePercent) - btcChange) * 10;
                    const score = Math.floor(rs + 20);
                    
                    const row = `<tr>
                        <td style="color:#888">${new Date().toLocaleTimeString()}</td>
                        <td><b>${coin.symbol.replace('USDT','')}</b></td>
                        <td class="up">+${growth.toFixed(2)}% <span class="trigger-tag">çˆ†ç™¼</span></td>
                        <td><span id="score-${coin.symbol}" style="font-weight:bold; color:#f2a900">${score}</span></td>
                        <td id="price-${coin.symbol}">${coin.lastPrice}</td>
                    </tr>`;
                    document.getElementById('watchlist').insertAdjacentHTML('afterbegin', row);
                }
            }
        } catch (e) { console.error("æƒæå‡ºéŒ¯", e); }
    }

    function startMonitoring() {
        isRunning = true;
        document.getElementById('startBtn').disabled = true;
        document.getElementById('startBtn').innerText = "ğŸ“¡ ç›£æ§é€²è¡Œä¸­...";
        // ç«‹å³åŸ·è¡Œä¸€æ¬¡æƒæ
        scan();
        // è¨­å®šå¾ªç’°
        setInterval(scan, 4000); 
    }

    // æ¯ä¸€ç§’æ›´æ–°ä¸€æ¬¡å¤§ç›¤åƒ¹æ ¼
    setInterval(updateMarket, 2000);
    updateMarket();
</script>
</body>
</html>
